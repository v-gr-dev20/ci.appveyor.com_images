version: 1.0.{build}
image:
  - Visual Studio 2019
  - Ubuntu2004
branches:
  only:
  - matrix_probes
configuration:
  - Debug
  - Release
platform: x64
environment:
  matrix:
  - BUILDER: MSBuilder
    HOST_OR_DOCKER: host
  - BUILDER: CMake
    HOST_OR_DOCKER: host
  - BUILDER: CMake
    HOST_OR_DOCKER: docker

for:
-
  matrix:
    exclude:
      - image: Ubuntu2004
        BUILDER: MSBuilder

  build_script:
  - sh: |
        echo "Current mode description:"
        echo "APPVEYOR_BUILD_WORKER_IMAGE=$APPVEYOR_BUILD_WORKER_IMAGE"
        echo "APPVEYOR_REPO_BRANCH=$APPVEYOR_REPO_BRANCH"
        echo "CONFIGURATION=$CONFIGURATION"
        echo "PLATFORM=$PLATFORM"
        echo "BUILDER=$BUILDER"
        echo "HOST_OR_DOCKER=$HOST_OR_DOCKER"
        echo "End of description."
  test_script:
  - sh: |
        echo "Tests OK"

-
  matrix:
    exclude:
      - image: Visual Studio 2019
        BUILDER: MSBuilder
        HOST_OR_DOCKER: docker
      - image: Visual Studio 2019
        BUILDER: CMake
        HOST_OR_DOCKER: docker

  build_script:
  - pwsh: |
          echo "Current mode description:"
          echo "APPVEYOR_BUILD_WORKER_IMAGE=$env:APPVEYOR_BUILD_WORKER_IMAGE"
          echo "APPVEYOR_REPO_BRANCH=$env:APPVEYOR_REPO_BRANCH"
          echo "CONFIGURATION=$env:CONFIGURATION"
          echo "PLATFORM=$env:PLATFORM"
          echo "BUILDER=$env:BUILDER"
          echo "HOST_OR_DOCKER=$env:HOST_OR_DOCKER"
          echo "End of description."
  test_script:
  - pwsh: |
        echo "Tests OK"
